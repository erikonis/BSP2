Starting...
/mnt/aiongpfs/users/ekadisa/micromamba/envs/CNN-project/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/mnt/aiongpfs/users/ekadisa/micromamba/envs/CNN-project/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=DenseNet169_Weights.IMAGENET1K_V1`. You can also use `weights=DenseNet169_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Entered main function. Starting training process.
start time:  1748205283.5795858
Made output directory:  best_dn169_raw/
Using device: cuda
model loaded in: 0.5822672843933105
data loaded
Epoch 1/40 - Loss: 0.5500 - Accuracy: 69.93%
Validation - Loss: 0.4630 - Accuracy: 77.34%
New best model saved with accuracy: 77.34%
Epoch 2/40 - Loss: 0.3462 - Accuracy: 83.80%
Validation - Loss: 0.3037 - Accuracy: 86.49%
New best model saved with accuracy: 86.49%
Epoch 3/40 - Loss: 0.2726 - Accuracy: 88.12%
Validation - Loss: 0.3105 - Accuracy: 86.49%
Epoch 4/40 - Loss: 0.2502 - Accuracy: 89.43%
Validation - Loss: 0.2488 - Accuracy: 89.83%
New best model saved with accuracy: 89.83%
Epoch 5/40 - Loss: 0.2260 - Accuracy: 90.66%
Validation - Loss: 0.2324 - Accuracy: 90.70%
New best model saved with accuracy: 90.70%
Epoch 6/40 - Loss: 0.1991 - Accuracy: 91.69%
Validation - Loss: 0.2107 - Accuracy: 91.57%
New best model saved with accuracy: 91.57%
Epoch 7/40 - Loss: 0.1944 - Accuracy: 91.65%
Validation - Loss: 0.2088 - Accuracy: 90.62%
Epoch 8/40 - Loss: 0.1654 - Accuracy: 93.48%
Validation - Loss: 0.2557 - Accuracy: 91.18%
Epoch 9/40 - Loss: 0.1577 - Accuracy: 94.00%
Validation - Loss: 0.2173 - Accuracy: 90.86%
Epoch 10/40 - Loss: 0.1468 - Accuracy: 94.10%
Validation - Loss: 0.2055 - Accuracy: 92.29%
New best model saved with accuracy: 92.29%
Epoch 11/40 - Loss: 0.1326 - Accuracy: 94.87%
Validation - Loss: 0.1885 - Accuracy: 93.64%
New best model saved with accuracy: 93.64%
Epoch 12/40 - Loss: 0.1213 - Accuracy: 95.65%
Validation - Loss: 0.1698 - Accuracy: 92.85%
Epoch 13/40 - Loss: 0.1274 - Accuracy: 95.05%
Validation - Loss: 0.2457 - Accuracy: 89.75%
Epoch 14/40 - Loss: 0.1155 - Accuracy: 95.13%
Validation - Loss: 0.1976 - Accuracy: 92.69%
Epoch 15/40 - Loss: 0.1049 - Accuracy: 96.24%
Validation - Loss: 0.2075 - Accuracy: 92.05%
Epoch 16/40 - Loss: 0.1136 - Accuracy: 95.77%
Validation - Loss: 0.2507 - Accuracy: 89.59%
Epoch 17/40 - Loss: 0.0892 - Accuracy: 96.48%
Validation - Loss: 0.1974 - Accuracy: 91.81%
Epoch 18/40 - Loss: 0.0936 - Accuracy: 96.30%
Validation - Loss: 0.2182 - Accuracy: 92.29%
Epoch 19/40 - Loss: 0.0901 - Accuracy: 96.60%
Validation - Loss: 0.1877 - Accuracy: 92.37%
Epoch 20/40 - Loss: 0.0729 - Accuracy: 97.22%
Validation - Loss: 0.1629 - Accuracy: 93.64%
Epoch 21/40 - Loss: 0.0760 - Accuracy: 96.96%
Validation - Loss: 0.1810 - Accuracy: 93.40%
Epoch 22/40 - Loss: 0.0791 - Accuracy: 97.10%
Validation - Loss: 0.1801 - Accuracy: 93.96%
New best model saved with accuracy: 93.96%
Epoch 23/40 - Loss: 0.0659 - Accuracy: 98.05%
Validation - Loss: 0.2121 - Accuracy: 92.53%
Epoch 24/40 - Loss: 0.0685 - Accuracy: 97.32%
Validation - Loss: 0.1712 - Accuracy: 93.80%
Epoch 25/40 - Loss: 0.0626 - Accuracy: 97.67%
Validation - Loss: 0.1942 - Accuracy: 93.00%
Epoch 26/40 - Loss: 0.0554 - Accuracy: 97.83%
Validation - Loss: 0.2168 - Accuracy: 92.53%
Epoch 27/40 - Loss: 0.0497 - Accuracy: 98.17%
Validation - Loss: 0.2611 - Accuracy: 92.85%
Epoch 28/40 - Loss: 0.0607 - Accuracy: 97.48%
Validation - Loss: 0.2635 - Accuracy: 92.05%
Epoch 29/40 - Loss: 0.0494 - Accuracy: 98.17%
Validation - Loss: 0.2350 - Accuracy: 93.96%
Epoch 30/40 - Loss: 0.0410 - Accuracy: 98.47%
Validation - Loss: 0.2890 - Accuracy: 93.00%
Epoch 31/40 - Loss: 0.0566 - Accuracy: 98.17%
Validation - Loss: 0.3123 - Accuracy: 92.45%
Epoch 32/40 - Loss: 0.0565 - Accuracy: 98.03%
Validation - Loss: 0.3443 - Accuracy: 88.55%
Epoch 33/40 - Loss: 0.0428 - Accuracy: 98.33%
Validation - Loss: 0.2276 - Accuracy: 92.93%
Epoch 34/40 - Loss: 0.0451 - Accuracy: 98.41%
Validation - Loss: 0.1812 - Accuracy: 94.04%
New best model saved with accuracy: 94.04%
Epoch 35/40 - Loss: 0.0366 - Accuracy: 98.57%
Validation - Loss: 0.2049 - Accuracy: 94.36%
New best model saved with accuracy: 94.36%
Epoch 36/40 - Loss: 0.0414 - Accuracy: 98.39%
Validation - Loss: 0.1915 - Accuracy: 94.12%
Epoch 37/40 - Loss: 0.0446 - Accuracy: 98.39%
Validation - Loss: 0.1889 - Accuracy: 93.88%
Epoch 38/40 - Loss: 0.0410 - Accuracy: 98.45%
Validation - Loss: 0.2135 - Accuracy: 94.91%
New best model saved with accuracy: 94.91%
Epoch 39/40 - Loss: 0.0400 - Accuracy: 98.65%
Validation - Loss: 0.2817 - Accuracy: 94.04%
Epoch 40/40 - Loss: 0.0343 - Accuracy: 98.67%
Validation - Loss: 0.2149 - Accuracy: 93.56%
Best model saved at epoch 38 with accuracy: 94.91%
trained model
metrics plotted
Loading the best model for evaluation...
Best model loaded successfully

Metrics saved to: best_dn169_raw/metrics_dn169_raw.txt
Test Accuracy: 98.00%
F1 Score: 0.9800
Recall: 0.9800
Precision: 0.9800
ROC AUC: 0.9967

Confidence statistics saved to: best_dn169_raw/confidence_statistics_dn169_raw.txt
model evaluated
it took:  1301.5671668052673
training time saved
Finished training process.
