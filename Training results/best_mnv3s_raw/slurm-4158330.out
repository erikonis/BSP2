Starting...
/mnt/aiongpfs/users/ekadisa/micromamba/envs/CNN-project/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/mnt/aiongpfs/users/ekadisa/micromamba/envs/CNN-project/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V3_Small_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V3_Small_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Entered main function. Starting training process.
start time:  1748785867.3849773
Made output directory:  best_mnv3s_raw/
Using device: cuda
model loaded in: 0.2545809745788574
data loaded
Epoch 1/40 - Loss: 0.6643 - Accuracy: 59.58%
Validation - Loss: 0.6542 - Accuracy: 62.64%
Validation loss decreased (inf → 0.654204). Saving model...
Epoch 2/40 - Loss: 0.5814 - Accuracy: 69.02%
Validation - Loss: 0.5773 - Accuracy: 65.58%
Validation loss decreased (0.654204 → 0.577293). Saving model...
Epoch 3/40 - Loss: 0.4843 - Accuracy: 76.03%
Validation - Loss: 0.4743 - Accuracy: 76.07%
Validation loss decreased (0.577293 → 0.474333). Saving model...
Epoch 4/40 - Loss: 0.4351 - Accuracy: 78.88%
Validation - Loss: 0.4131 - Accuracy: 81.32%
Validation loss decreased (0.474333 → 0.413068). Saving model...
Epoch 5/40 - Loss: 0.4136 - Accuracy: 80.64%
Validation - Loss: 0.4102 - Accuracy: 82.11%
Validation loss decreased (0.413068 → 0.410186). Saving model...
Epoch 6/40 - Loss: 0.3881 - Accuracy: 81.26%
Validation - Loss: 0.3809 - Accuracy: 82.19%
Validation loss decreased (0.410186 → 0.380940). Saving model...
Epoch 7/40 - Loss: 0.3544 - Accuracy: 83.60%
Validation - Loss: 0.3599 - Accuracy: 83.39%
Validation loss decreased (0.380940 → 0.359894). Saving model...
Epoch 8/40 - Loss: 0.3611 - Accuracy: 83.17%
Validation - Loss: 0.3398 - Accuracy: 85.29%
Validation loss decreased (0.359894 → 0.339781). Saving model...
Epoch 9/40 - Loss: 0.3315 - Accuracy: 85.25%
Validation - Loss: 0.3458 - Accuracy: 84.58%
EarlyStopping counter: 1 out of 5
Epoch 10/40 - Loss: 0.3272 - Accuracy: 85.21%
Validation - Loss: 0.3315 - Accuracy: 86.01%
Validation loss decreased (0.339781 → 0.331503). Saving model...
Epoch 11/40 - Loss: 0.3079 - Accuracy: 86.41%
Validation - Loss: 0.3193 - Accuracy: 86.25%
Validation loss decreased (0.331503 → 0.319313). Saving model...
Epoch 12/40 - Loss: 0.3029 - Accuracy: 86.17%
Validation - Loss: 0.2786 - Accuracy: 87.20%
Validation loss decreased (0.319313 → 0.278585). Saving model...
Epoch 13/40 - Loss: 0.2924 - Accuracy: 86.80%
Validation - Loss: 0.3051 - Accuracy: 87.04%
EarlyStopping counter: 1 out of 5
Epoch 14/40 - Loss: 0.2822 - Accuracy: 87.74%
Validation - Loss: 0.4124 - Accuracy: 77.03%
EarlyStopping counter: 2 out of 5
Epoch 15/40 - Loss: 0.2864 - Accuracy: 87.22%
Validation - Loss: 0.3314 - Accuracy: 85.93%
EarlyStopping counter: 3 out of 5
Epoch 16/40 - Loss: 0.2742 - Accuracy: 87.82%
Validation - Loss: 0.3085 - Accuracy: 85.93%
EarlyStopping counter: 4 out of 5
Epoch 17/40 - Loss: 0.2641 - Accuracy: 88.85%
Validation - Loss: 0.2974 - Accuracy: 87.52%
EarlyStopping counter: 5 out of 5
Epoch 18/40 - Loss: 0.2601 - Accuracy: 88.43%
Validation - Loss: 0.2902 - Accuracy: 86.88%
Epoch 19/40 - Loss: 0.2507 - Accuracy: 89.41%
Validation - Loss: 0.3233 - Accuracy: 85.06%
Epoch 20/40 - Loss: 0.2480 - Accuracy: 89.35%
Validation - Loss: 0.2674 - Accuracy: 88.16%
Epoch 21/40 - Loss: 0.2464 - Accuracy: 89.29%
Validation - Loss: 0.2638 - Accuracy: 89.11%
Epoch 22/40 - Loss: 0.2415 - Accuracy: 89.53%
Validation - Loss: 0.2968 - Accuracy: 87.92%
Epoch 23/40 - Loss: 0.2293 - Accuracy: 89.96%
Validation - Loss: 0.3455 - Accuracy: 83.78%
Epoch 24/40 - Loss: 0.2335 - Accuracy: 90.04%
Validation - Loss: 0.2690 - Accuracy: 88.08%
Epoch 25/40 - Loss: 0.2243 - Accuracy: 90.84%
Validation - Loss: 0.2605 - Accuracy: 88.24%
Epoch 26/40 - Loss: 0.2179 - Accuracy: 90.74%
Validation - Loss: 0.3627 - Accuracy: 83.31%
Epoch 27/40 - Loss: 0.2191 - Accuracy: 91.04%
Validation - Loss: 0.2845 - Accuracy: 87.44%
Epoch 28/40 - Loss: 0.2081 - Accuracy: 90.70%
Validation - Loss: 0.2569 - Accuracy: 89.43%
Epoch 29/40 - Loss: 0.1940 - Accuracy: 91.83%
Validation - Loss: 0.2899 - Accuracy: 86.88%
Epoch 30/40 - Loss: 0.2012 - Accuracy: 91.45%
Validation - Loss: 0.2563 - Accuracy: 89.51%
Epoch 31/40 - Loss: 0.2022 - Accuracy: 91.91%
Validation - Loss: 0.2697 - Accuracy: 89.27%
Epoch 32/40 - Loss: 0.1870 - Accuracy: 92.05%
Validation - Loss: 0.2609 - Accuracy: 89.43%
Epoch 33/40 - Loss: 0.1961 - Accuracy: 91.89%
Validation - Loss: 0.2683 - Accuracy: 88.79%
Epoch 34/40 - Loss: 0.1892 - Accuracy: 92.57%
Validation - Loss: 0.3465 - Accuracy: 84.50%
Epoch 35/40 - Loss: 0.1769 - Accuracy: 92.53%
Validation - Loss: 0.2783 - Accuracy: 88.00%
Epoch 36/40 - Loss: 0.1801 - Accuracy: 92.47%
Validation - Loss: 0.2516 - Accuracy: 90.38%
Epoch 37/40 - Loss: 0.1749 - Accuracy: 92.87%
Validation - Loss: 0.2578 - Accuracy: 88.24%
Epoch 38/40 - Loss: 0.1780 - Accuracy: 92.65%
Validation - Loss: 0.3121 - Accuracy: 87.20%
Epoch 39/40 - Loss: 0.1622 - Accuracy: 93.20%
Validation - Loss: 0.3050 - Accuracy: 87.68%
Epoch 40/40 - Loss: 0.1670 - Accuracy: 93.40%
Validation - Loss: 0.3070 - Accuracy: 87.28%
Best model saved at epoch 12 with accuracy: 87.20%
trained model
metrics plotted
Loading the best model for evaluation...
Best model loaded successfully

Metrics saved to: best_mnv3s_raw/metrics_mnv3s_raw.txt
Test Accuracy: 83.50%
F1 Score: 0.8216
Recall: 0.7600
Precision: 0.8941
ROC AUC: 0.9471

Confidence statistics saved to: best_mnv3s_raw/confidence_statistics_mnv3s_raw.txt
model evaluated
it took:  609.4219844341278
training time saved
Finished training process.
