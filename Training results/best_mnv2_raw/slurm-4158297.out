Starting...
/mnt/aiongpfs/users/ekadisa/micromamba/envs/CNN-project/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/mnt/aiongpfs/users/ekadisa/micromamba/envs/CNN-project/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Entered main function. Starting training process.
start time:  1748782587.3076901
Made output directory:  best_mnv2_raw/
Using device: cuda
model loaded in: 0.6449565887451172
data loaded
Epoch 1/40 - Loss: 0.6283 - Accuracy: 63.65%
Validation - Loss: 0.5447 - Accuracy: 71.30%
Validation loss decreased (inf → 0.544711). Saving model...
Epoch 2/40 - Loss: 0.4685 - Accuracy: 76.39%
Validation - Loss: 0.4376 - Accuracy: 78.78%
Validation loss decreased (0.544711 → 0.437598). Saving model...
Epoch 3/40 - Loss: 0.3940 - Accuracy: 80.70%
Validation - Loss: 0.3918 - Accuracy: 81.24%
Validation loss decreased (0.437598 → 0.391809). Saving model...
Epoch 4/40 - Loss: 0.3550 - Accuracy: 83.29%
Validation - Loss: 0.3259 - Accuracy: 85.53%
Validation loss decreased (0.391809 → 0.325870). Saving model...
Epoch 5/40 - Loss: 0.3208 - Accuracy: 85.12%
Validation - Loss: 0.3423 - Accuracy: 84.50%
EarlyStopping counter: 1 out of 5
Epoch 6/40 - Loss: 0.3073 - Accuracy: 86.11%
Validation - Loss: 0.2821 - Accuracy: 87.44%
Validation loss decreased (0.325870 → 0.282062). Saving model...
Epoch 7/40 - Loss: 0.2726 - Accuracy: 87.80%
Validation - Loss: 0.2615 - Accuracy: 88.55%
Validation loss decreased (0.282062 → 0.261528). Saving model...
Epoch 8/40 - Loss: 0.2603 - Accuracy: 89.03%
Validation - Loss: 0.2916 - Accuracy: 87.36%
EarlyStopping counter: 1 out of 5
Epoch 9/40 - Loss: 0.2410 - Accuracy: 89.63%
Validation - Loss: 0.2654 - Accuracy: 88.00%
EarlyStopping counter: 2 out of 5
Epoch 10/40 - Loss: 0.2387 - Accuracy: 89.67%
Validation - Loss: 0.2598 - Accuracy: 89.27%
Validation loss decreased (0.261528 → 0.259792). Saving model...
Epoch 11/40 - Loss: 0.2120 - Accuracy: 91.06%
Validation - Loss: 0.2868 - Accuracy: 89.67%
EarlyStopping counter: 1 out of 5
Epoch 12/40 - Loss: 0.2125 - Accuracy: 90.98%
Validation - Loss: 0.2300 - Accuracy: 88.95%
Validation loss decreased (0.259792 → 0.229980). Saving model...
Epoch 13/40 - Loss: 0.1905 - Accuracy: 92.17%
Validation - Loss: 0.2197 - Accuracy: 91.02%
Validation loss decreased (0.229980 → 0.219726). Saving model...
Epoch 14/40 - Loss: 0.1919 - Accuracy: 91.85%
Validation - Loss: 0.2551 - Accuracy: 89.35%
EarlyStopping counter: 1 out of 5
Epoch 15/40 - Loss: 0.1804 - Accuracy: 92.53%
Validation - Loss: 0.2671 - Accuracy: 88.95%
EarlyStopping counter: 2 out of 5
Epoch 16/40 - Loss: 0.1777 - Accuracy: 92.39%
Validation - Loss: 0.2200 - Accuracy: 90.86%
EarlyStopping counter: 3 out of 5
Epoch 17/40 - Loss: 0.1716 - Accuracy: 93.02%
Validation - Loss: 0.2436 - Accuracy: 91.57%
EarlyStopping counter: 4 out of 5
Epoch 18/40 - Loss: 0.1691 - Accuracy: 92.93%
Validation - Loss: 0.2400 - Accuracy: 90.86%
EarlyStopping counter: 5 out of 5
Epoch 19/40 - Loss: 0.1512 - Accuracy: 94.16%
Validation - Loss: 0.1985 - Accuracy: 91.73%
Epoch 20/40 - Loss: 0.1448 - Accuracy: 93.84%
Validation - Loss: 0.1929 - Accuracy: 91.97%
Epoch 21/40 - Loss: 0.1672 - Accuracy: 94.48%
Validation - Loss: 0.2323 - Accuracy: 91.41%
Epoch 22/40 - Loss: 0.1537 - Accuracy: 93.74%
Validation - Loss: 0.2307 - Accuracy: 90.94%
Epoch 23/40 - Loss: 0.1335 - Accuracy: 94.63%
Validation - Loss: 0.2129 - Accuracy: 91.18%
Epoch 24/40 - Loss: 0.1241 - Accuracy: 94.91%
Validation - Loss: 0.2129 - Accuracy: 91.89%
Epoch 25/40 - Loss: 0.1358 - Accuracy: 94.75%
Validation - Loss: 0.2361 - Accuracy: 91.41%
Epoch 26/40 - Loss: 0.1232 - Accuracy: 94.95%
Validation - Loss: 0.2099 - Accuracy: 92.53%
Epoch 27/40 - Loss: 0.1146 - Accuracy: 95.31%
Validation - Loss: 0.1913 - Accuracy: 92.77%
Epoch 28/40 - Loss: 0.0983 - Accuracy: 96.12%
Validation - Loss: 0.2301 - Accuracy: 92.37%
Epoch 29/40 - Loss: 0.1021 - Accuracy: 96.10%
Validation - Loss: 0.2346 - Accuracy: 90.94%
Epoch 30/40 - Loss: 0.0912 - Accuracy: 96.34%
Validation - Loss: 0.2256 - Accuracy: 92.77%
Epoch 31/40 - Loss: 0.1033 - Accuracy: 95.97%
Validation - Loss: 0.2185 - Accuracy: 91.02%
Epoch 32/40 - Loss: 0.0834 - Accuracy: 96.72%
Validation - Loss: 0.2012 - Accuracy: 92.37%
Epoch 33/40 - Loss: 0.0794 - Accuracy: 96.96%
Validation - Loss: 0.2251 - Accuracy: 92.21%
Epoch 34/40 - Loss: 0.0865 - Accuracy: 96.66%
Validation - Loss: 0.2465 - Accuracy: 91.81%
Epoch 35/40 - Loss: 0.0742 - Accuracy: 97.16%
Validation - Loss: 0.2117 - Accuracy: 93.00%
Epoch 36/40 - Loss: 0.0847 - Accuracy: 96.62%
Validation - Loss: 0.2505 - Accuracy: 90.94%
Epoch 37/40 - Loss: 0.0667 - Accuracy: 97.42%
Validation - Loss: 0.2467 - Accuracy: 92.05%
Epoch 38/40 - Loss: 0.0712 - Accuracy: 97.22%
Validation - Loss: 0.2306 - Accuracy: 92.21%
Epoch 39/40 - Loss: 0.0711 - Accuracy: 97.18%
Validation - Loss: 0.2476 - Accuracy: 91.97%
Epoch 40/40 - Loss: 0.0642 - Accuracy: 97.48%
Validation - Loss: 0.2755 - Accuracy: 91.02%
Best model saved at epoch 13 with accuracy: 91.02%
trained model
metrics plotted
Loading the best model for evaluation...
Best model loaded successfully

Metrics saved to: best_mnv2_raw/metrics_mnv2_raw.txt
Test Accuracy: 95.00%
F1 Score: 0.9490
Recall: 0.9300
Precision: 0.9688
ROC AUC: 0.9885

Confidence statistics saved to: best_mnv2_raw/confidence_statistics_mnv2_raw.txt
model evaluated
it took:  681.3923370838165
training time saved
Finished training process.
