Starting...
/mnt/aiongpfs/users/ekadisa/micromamba/envs/CNN-project/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/mnt/aiongpfs/users/ekadisa/micromamba/envs/CNN-project/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V3_Large_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V3_Large_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Entered main function. Starting training process.
start time:  1748785331.29133
Made output directory:  best_mnv3_raw/
Using device: cuda
model loaded in: 0.34741806983947754
data loaded
Epoch 1/40 - Loss: 0.6536 - Accuracy: 60.67%
Validation - Loss: 0.6510 - Accuracy: 62.40%
Validation loss decreased (inf → 0.650999). Saving model...
Epoch 2/40 - Loss: 0.5466 - Accuracy: 71.03%
Validation - Loss: 0.5215 - Accuracy: 72.73%
Validation loss decreased (0.650999 → 0.521527). Saving model...
Epoch 3/40 - Loss: 0.4404 - Accuracy: 78.70%
Validation - Loss: 0.4497 - Accuracy: 77.42%
Validation loss decreased (0.521527 → 0.449667). Saving model...
Epoch 4/40 - Loss: 0.3819 - Accuracy: 81.74%
Validation - Loss: 0.3753 - Accuracy: 82.51%
Validation loss decreased (0.449667 → 0.375330). Saving model...
Epoch 5/40 - Loss: 0.3530 - Accuracy: 83.11%
Validation - Loss: 0.3446 - Accuracy: 84.10%
Validation loss decreased (0.375330 → 0.344578). Saving model...
Epoch 6/40 - Loss: 0.3273 - Accuracy: 85.17%
Validation - Loss: 0.3539 - Accuracy: 82.91%
EarlyStopping counter: 1 out of 5
Epoch 7/40 - Loss: 0.3089 - Accuracy: 85.69%
Validation - Loss: 0.3416 - Accuracy: 85.06%
Validation loss decreased (0.344578 → 0.341634). Saving model...
Epoch 8/40 - Loss: 0.2857 - Accuracy: 87.40%
Validation - Loss: 0.2998 - Accuracy: 85.37%
Validation loss decreased (0.341634 → 0.299799). Saving model...
Epoch 9/40 - Loss: 0.2746 - Accuracy: 87.88%
Validation - Loss: 0.2955 - Accuracy: 86.41%
Validation loss decreased (0.299799 → 0.295497). Saving model...
Epoch 10/40 - Loss: 0.2683 - Accuracy: 88.22%
Validation - Loss: 0.2995 - Accuracy: 85.61%
EarlyStopping counter: 1 out of 5
Epoch 11/40 - Loss: 0.2557 - Accuracy: 88.71%
Validation - Loss: 0.3012 - Accuracy: 86.96%
EarlyStopping counter: 2 out of 5
Epoch 12/40 - Loss: 0.2298 - Accuracy: 89.75%
Validation - Loss: 0.2700 - Accuracy: 88.16%
Validation loss decreased (0.295497 → 0.269975). Saving model...
Epoch 13/40 - Loss: 0.2281 - Accuracy: 90.28%
Validation - Loss: 0.7921 - Accuracy: 68.76%
EarlyStopping counter: 1 out of 5
Epoch 14/40 - Loss: 0.2142 - Accuracy: 91.28%
Validation - Loss: 0.3563 - Accuracy: 84.26%
EarlyStopping counter: 2 out of 5
Epoch 15/40 - Loss: 0.2072 - Accuracy: 91.22%
Validation - Loss: 0.2643 - Accuracy: 88.00%
Validation loss decreased (0.269975 → 0.264261). Saving model...
Epoch 16/40 - Loss: 0.1994 - Accuracy: 91.28%
Validation - Loss: 0.2533 - Accuracy: 88.63%
Validation loss decreased (0.264261 → 0.253287). Saving model...
Epoch 17/40 - Loss: 0.1893 - Accuracy: 92.09%
Validation - Loss: 0.2792 - Accuracy: 87.68%
EarlyStopping counter: 1 out of 5
Epoch 18/40 - Loss: 0.1818 - Accuracy: 92.35%
Validation - Loss: 0.2883 - Accuracy: 87.44%
EarlyStopping counter: 2 out of 5
Epoch 19/40 - Loss: 0.1795 - Accuracy: 92.69%
Validation - Loss: 0.2170 - Accuracy: 91.49%
Validation loss decreased (0.253287 → 0.217037). Saving model...
Epoch 20/40 - Loss: 0.1705 - Accuracy: 93.04%
Validation - Loss: 0.5629 - Accuracy: 79.49%
EarlyStopping counter: 1 out of 5
Epoch 21/40 - Loss: 0.1685 - Accuracy: 93.02%
Validation - Loss: 0.2488 - Accuracy: 90.14%
EarlyStopping counter: 2 out of 5
Epoch 22/40 - Loss: 0.1614 - Accuracy: 93.56%
Validation - Loss: 0.2569 - Accuracy: 89.90%
EarlyStopping counter: 3 out of 5
Epoch 23/40 - Loss: 0.1484 - Accuracy: 94.20%
Validation - Loss: 0.2463 - Accuracy: 90.30%
EarlyStopping counter: 4 out of 5
Epoch 24/40 - Loss: 0.1305 - Accuracy: 94.93%
Validation - Loss: 0.3276 - Accuracy: 87.36%
EarlyStopping counter: 5 out of 5
Epoch 25/40 - Loss: 0.1306 - Accuracy: 95.01%
Validation - Loss: 0.2441 - Accuracy: 91.10%
Epoch 26/40 - Loss: 0.1238 - Accuracy: 95.19%
Validation - Loss: 0.2400 - Accuracy: 91.10%
Epoch 27/40 - Loss: 0.1218 - Accuracy: 95.31%
Validation - Loss: 0.2899 - Accuracy: 88.08%
Epoch 28/40 - Loss: 0.1089 - Accuracy: 95.67%
Validation - Loss: 0.3159 - Accuracy: 87.36%
Epoch 29/40 - Loss: 0.1168 - Accuracy: 95.57%
Validation - Loss: 0.3098 - Accuracy: 90.14%
Epoch 30/40 - Loss: 0.1209 - Accuracy: 95.07%
Validation - Loss: 0.4084 - Accuracy: 85.45%
Epoch 31/40 - Loss: 0.1011 - Accuracy: 96.28%
Validation - Loss: 0.2578 - Accuracy: 90.38%
Epoch 32/40 - Loss: 0.0902 - Accuracy: 96.44%
Validation - Loss: 0.3407 - Accuracy: 88.00%
Epoch 33/40 - Loss: 0.0884 - Accuracy: 96.62%
Validation - Loss: 0.3710 - Accuracy: 87.28%
Epoch 34/40 - Loss: 0.0883 - Accuracy: 96.92%
Validation - Loss: 0.2710 - Accuracy: 90.22%
Epoch 35/40 - Loss: 0.0868 - Accuracy: 96.50%
Validation - Loss: 0.4014 - Accuracy: 85.45%
Epoch 36/40 - Loss: 0.0796 - Accuracy: 97.04%
Validation - Loss: 0.2678 - Accuracy: 90.94%
Epoch 37/40 - Loss: 0.0702 - Accuracy: 97.32%
Validation - Loss: 0.2721 - Accuracy: 91.10%
Epoch 38/40 - Loss: 0.0713 - Accuracy: 97.32%
Validation - Loss: 0.4528 - Accuracy: 85.37%
Epoch 39/40 - Loss: 0.0662 - Accuracy: 97.64%
Validation - Loss: 0.3828 - Accuracy: 90.30%
Epoch 40/40 - Loss: 0.0669 - Accuracy: 97.38%
Validation - Loss: 0.2804 - Accuracy: 91.18%
Best model saved at epoch 19 with accuracy: 91.49%
trained model
metrics plotted
Loading the best model for evaluation...
Best model loaded successfully

Metrics saved to: best_mnv3_raw/metrics_mnv3_raw.txt
Test Accuracy: 85.50%
F1 Score: 0.8466
Recall: 0.8000
Precision: 0.8989
ROC AUC: 0.9577

Confidence statistics saved to: best_mnv3_raw/confidence_statistics_mnv3_raw.txt
model evaluated
it took:  610.7851054668427
training time saved
Finished training process.
