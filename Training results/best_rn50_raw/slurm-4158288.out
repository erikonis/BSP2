Starting...
/mnt/aiongpfs/users/ekadisa/micromamba/envs/CNN-project/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/mnt/aiongpfs/users/ekadisa/micromamba/envs/CNN-project/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Entered main function. Starting training process.
start time:  1748781071.2092218
Made output directory:  best_rn50_raw/
Using device: cuda
model loaded in: 1.3810033798217773
data loaded
Epoch 1/40 - Loss: 0.5188 - Accuracy: 72.20%
Validation - Loss: 0.4239 - Accuracy: 78.46%
Validation loss decreased (inf → 0.423893). Saving model...
Epoch 2/40 - Loss: 0.3560 - Accuracy: 83.11%
Validation - Loss: 0.3111 - Accuracy: 86.80%
Validation loss decreased (0.423893 → 0.311077). Saving model...
Epoch 3/40 - Loss: 0.2934 - Accuracy: 86.92%
Validation - Loss: 0.2829 - Accuracy: 88.16%
Validation loss decreased (0.311077 → 0.282926). Saving model...
Epoch 4/40 - Loss: 0.2671 - Accuracy: 88.33%
Validation - Loss: 0.4069 - Accuracy: 80.13%
EarlyStopping counter: 1 out of 5
Epoch 5/40 - Loss: 0.2473 - Accuracy: 89.13%
Validation - Loss: 0.2633 - Accuracy: 88.00%
Validation loss decreased (0.282926 → 0.263271). Saving model...
Epoch 6/40 - Loss: 0.2251 - Accuracy: 90.30%
Validation - Loss: 0.1986 - Accuracy: 91.81%
Validation loss decreased (0.263271 → 0.198618). Saving model...
Epoch 7/40 - Loss: 0.2127 - Accuracy: 91.30%
Validation - Loss: 0.2111 - Accuracy: 91.18%
EarlyStopping counter: 1 out of 5
Epoch 8/40 - Loss: 0.1928 - Accuracy: 92.15%
Validation - Loss: 0.2252 - Accuracy: 91.41%
EarlyStopping counter: 2 out of 5
Epoch 9/40 - Loss: 0.1906 - Accuracy: 92.01%
Validation - Loss: 0.1773 - Accuracy: 92.69%
Validation loss decreased (0.198618 → 0.177251). Saving model...
Epoch 10/40 - Loss: 0.1699 - Accuracy: 93.56%
Validation - Loss: 0.2036 - Accuracy: 92.37%
EarlyStopping counter: 1 out of 5
Epoch 11/40 - Loss: 0.1656 - Accuracy: 93.04%
Validation - Loss: 0.2331 - Accuracy: 89.98%
EarlyStopping counter: 2 out of 5
Epoch 12/40 - Loss: 0.1629 - Accuracy: 93.34%
Validation - Loss: 0.2200 - Accuracy: 92.61%
EarlyStopping counter: 3 out of 5
Epoch 13/40 - Loss: 0.1487 - Accuracy: 94.06%
Validation - Loss: 0.2378 - Accuracy: 90.46%
EarlyStopping counter: 4 out of 5
Epoch 14/40 - Loss: 0.1399 - Accuracy: 94.34%
Validation - Loss: 0.1990 - Accuracy: 92.21%
EarlyStopping counter: 5 out of 5
Epoch 15/40 - Loss: 0.1364 - Accuracy: 94.28%
Validation - Loss: 0.1950 - Accuracy: 92.53%
Epoch 16/40 - Loss: 0.1319 - Accuracy: 95.01%
Validation - Loss: 0.1742 - Accuracy: 93.32%
Epoch 17/40 - Loss: 0.1130 - Accuracy: 95.71%
Validation - Loss: 0.2187 - Accuracy: 92.85%
Epoch 18/40 - Loss: 0.1100 - Accuracy: 95.51%
Validation - Loss: 0.2154 - Accuracy: 92.53%
Epoch 19/40 - Loss: 0.1086 - Accuracy: 95.69%
Validation - Loss: 0.1711 - Accuracy: 92.69%
Epoch 20/40 - Loss: 0.1026 - Accuracy: 95.99%
Validation - Loss: 0.2007 - Accuracy: 93.16%
Epoch 21/40 - Loss: 0.1066 - Accuracy: 95.73%
Validation - Loss: 0.1579 - Accuracy: 94.75%
Epoch 22/40 - Loss: 0.1058 - Accuracy: 95.95%
Validation - Loss: 0.2112 - Accuracy: 91.97%
Epoch 23/40 - Loss: 0.1015 - Accuracy: 95.97%
Validation - Loss: 0.1754 - Accuracy: 92.37%
Epoch 24/40 - Loss: 0.0824 - Accuracy: 96.82%
Validation - Loss: 0.2086 - Accuracy: 93.64%
Epoch 25/40 - Loss: 0.0832 - Accuracy: 97.02%
Validation - Loss: 0.1438 - Accuracy: 93.48%
Epoch 26/40 - Loss: 0.0974 - Accuracy: 96.36%
Validation - Loss: 0.1579 - Accuracy: 93.56%
Epoch 27/40 - Loss: 0.0850 - Accuracy: 96.92%
Validation - Loss: 0.2229 - Accuracy: 91.10%
Epoch 28/40 - Loss: 0.0703 - Accuracy: 97.24%
Validation - Loss: 0.1499 - Accuracy: 94.52%
Epoch 29/40 - Loss: 0.0767 - Accuracy: 96.94%
Validation - Loss: 0.1906 - Accuracy: 94.12%
Epoch 30/40 - Loss: 0.0721 - Accuracy: 97.42%
Validation - Loss: 0.1884 - Accuracy: 92.69%
Epoch 31/40 - Loss: 0.0726 - Accuracy: 97.44%
Validation - Loss: 0.1879 - Accuracy: 91.97%
Epoch 32/40 - Loss: 0.0636 - Accuracy: 97.58%
Validation - Loss: 0.1774 - Accuracy: 93.40%
Epoch 33/40 - Loss: 0.0593 - Accuracy: 97.97%
Validation - Loss: 0.3448 - Accuracy: 87.28%
Epoch 34/40 - Loss: 0.0717 - Accuracy: 97.18%
Validation - Loss: 0.2222 - Accuracy: 93.08%
Epoch 35/40 - Loss: 0.0664 - Accuracy: 97.77%
Validation - Loss: 0.2143 - Accuracy: 91.73%
Epoch 36/40 - Loss: 0.0655 - Accuracy: 97.46%
Validation - Loss: 0.1864 - Accuracy: 94.52%
Epoch 37/40 - Loss: 0.0514 - Accuracy: 98.19%
Validation - Loss: 0.3093 - Accuracy: 91.81%
Epoch 38/40 - Loss: 0.0592 - Accuracy: 97.85%
Validation - Loss: 0.1873 - Accuracy: 94.04%
Epoch 39/40 - Loss: 0.0697 - Accuracy: 97.58%
Validation - Loss: 0.3062 - Accuracy: 93.16%
Epoch 40/40 - Loss: 0.0583 - Accuracy: 97.75%
Validation - Loss: 0.1684 - Accuracy: 93.72%
Best model saved at epoch 9 with accuracy: 92.69%
trained model
metrics plotted
Loading the best model for evaluation...
Best model loaded successfully

Metrics saved to: best_rn50_raw/metrics_rn50_raw.txt
Test Accuracy: 94.50%
F1 Score: 0.9430
Recall: 0.9100
Precision: 0.9785
ROC AUC: 0.9913

Confidence statistics saved to: best_rn50_raw/confidence_statistics_rn50_raw.txt
model evaluated
it took:  1066.8678874969482
training time saved
Finished training process.
