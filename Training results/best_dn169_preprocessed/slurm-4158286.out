Starting...
/mnt/aiongpfs/users/ekadisa/micromamba/envs/CNN-project/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/mnt/aiongpfs/users/ekadisa/micromamba/envs/CNN-project/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=DenseNet169_Weights.IMAGENET1K_V1`. You can also use `weights=DenseNet169_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Entered main function. Starting training process.
start time:  1748780968.225163
Made output directory:  best_dn169_preprocessed/
Using device: cuda
model loaded in: 0.5061283111572266
data loaded
Epoch 1/40 - Loss: 0.6521 - Accuracy: 60.86%
Validation - Loss: 0.5550 - Accuracy: 70.65%
Validation loss decreased (inf → 0.554980). Saving model...
Epoch 2/40 - Loss: 0.4363 - Accuracy: 79.08%
Validation - Loss: 0.2910 - Accuracy: 87.79%
Validation loss decreased (0.554980 → 0.291026). Saving model...
Epoch 3/40 - Loss: 0.2975 - Accuracy: 87.38%
Validation - Loss: 0.2586 - Accuracy: 89.31%
Validation loss decreased (0.291026 → 0.258579). Saving model...
Epoch 4/40 - Loss: 0.2624 - Accuracy: 88.93%
Validation - Loss: 0.2245 - Accuracy: 91.26%
Validation loss decreased (0.258579 → 0.224461). Saving model...
Epoch 5/40 - Loss: 0.2400 - Accuracy: 89.86%
Validation - Loss: 0.2429 - Accuracy: 91.60%
EarlyStopping counter: 1 out of 5
Epoch 6/40 - Loss: 0.2146 - Accuracy: 91.01%
Validation - Loss: 0.2156 - Accuracy: 92.96%
Validation loss decreased (0.224461 → 0.215593). Saving model...
Epoch 7/40 - Loss: 0.1976 - Accuracy: 92.17%
Validation - Loss: 0.2064 - Accuracy: 92.11%
Validation loss decreased (0.215593 → 0.206370). Saving model...
Epoch 8/40 - Loss: 0.1938 - Accuracy: 92.28%
Validation - Loss: 0.2043 - Accuracy: 92.03%
Validation loss decreased (0.206370 → 0.204273). Saving model...
Epoch 9/40 - Loss: 0.1826 - Accuracy: 92.70%
Validation - Loss: 0.2102 - Accuracy: 92.45%
EarlyStopping counter: 1 out of 5
Epoch 10/40 - Loss: 0.1695 - Accuracy: 92.89%
Validation - Loss: 0.1990 - Accuracy: 93.13%
Validation loss decreased (0.204273 → 0.199011). Saving model...
Epoch 11/40 - Loss: 0.1600 - Accuracy: 93.76%
Validation - Loss: 0.1749 - Accuracy: 93.98%
Validation loss decreased (0.199011 → 0.174936). Saving model...
Epoch 12/40 - Loss: 0.1452 - Accuracy: 94.48%
Validation - Loss: 0.2188 - Accuracy: 90.25%
EarlyStopping counter: 1 out of 5
Epoch 13/40 - Loss: 0.1329 - Accuracy: 94.65%
Validation - Loss: 0.2194 - Accuracy: 91.01%
EarlyStopping counter: 2 out of 5
Epoch 14/40 - Loss: 0.1375 - Accuracy: 94.00%
Validation - Loss: 0.2107 - Accuracy: 92.62%
EarlyStopping counter: 3 out of 5
Epoch 15/40 - Loss: 0.1435 - Accuracy: 94.23%
Validation - Loss: 0.2331 - Accuracy: 92.28%
EarlyStopping counter: 4 out of 5
Epoch 16/40 - Loss: 0.1341 - Accuracy: 94.74%
Validation - Loss: 0.1768 - Accuracy: 94.06%
EarlyStopping counter: 5 out of 5
Epoch 17/40 - Loss: 0.1148 - Accuracy: 95.57%
Validation - Loss: 0.2372 - Accuracy: 90.50%
Epoch 18/40 - Loss: 0.1129 - Accuracy: 95.38%
Validation - Loss: 0.1957 - Accuracy: 93.47%
Epoch 19/40 - Loss: 0.0971 - Accuracy: 95.99%
Validation - Loss: 0.2884 - Accuracy: 89.40%
Epoch 20/40 - Loss: 0.0861 - Accuracy: 96.82%
Validation - Loss: 0.2007 - Accuracy: 94.06%
Epoch 21/40 - Loss: 0.0950 - Accuracy: 96.56%
Validation - Loss: 0.3182 - Accuracy: 89.57%
Epoch 22/40 - Loss: 0.0920 - Accuracy: 96.63%
Validation - Loss: 0.2437 - Accuracy: 90.67%
Epoch 23/40 - Loss: 0.0909 - Accuracy: 96.29%
Validation - Loss: 0.2194 - Accuracy: 92.54%
Epoch 24/40 - Loss: 0.0765 - Accuracy: 96.92%
Validation - Loss: 0.4103 - Accuracy: 87.36%
Epoch 25/40 - Loss: 0.0757 - Accuracy: 97.18%
Validation - Loss: 0.3221 - Accuracy: 89.57%
Epoch 26/40 - Loss: 0.0782 - Accuracy: 97.16%
Validation - Loss: 0.2353 - Accuracy: 94.06%
Epoch 27/40 - Loss: 0.0948 - Accuracy: 96.67%
Validation - Loss: 0.2454 - Accuracy: 93.55%
Epoch 28/40 - Loss: 0.0599 - Accuracy: 97.77%
Validation - Loss: 0.2329 - Accuracy: 92.54%
Epoch 29/40 - Loss: 0.0521 - Accuracy: 98.07%
Validation - Loss: 0.2057 - Accuracy: 94.66%
Epoch 30/40 - Loss: 0.0567 - Accuracy: 97.86%
Validation - Loss: 0.2398 - Accuracy: 91.52%
Epoch 31/40 - Loss: 0.0563 - Accuracy: 97.82%
Validation - Loss: 0.1965 - Accuracy: 93.98%
Epoch 32/40 - Loss: 0.0576 - Accuracy: 97.94%
Validation - Loss: 0.1947 - Accuracy: 93.47%
Epoch 33/40 - Loss: 0.0481 - Accuracy: 98.35%
Validation - Loss: 0.2438 - Accuracy: 93.64%
Epoch 34/40 - Loss: 0.0440 - Accuracy: 98.58%
Validation - Loss: 0.2304 - Accuracy: 93.04%
Epoch 35/40 - Loss: 0.0459 - Accuracy: 98.15%
Validation - Loss: 0.3000 - Accuracy: 92.71%
Epoch 36/40 - Loss: 0.0588 - Accuracy: 97.88%
Validation - Loss: 0.2690 - Accuracy: 92.45%
Epoch 37/40 - Loss: 0.0411 - Accuracy: 98.43%
Validation - Loss: 0.2505 - Accuracy: 93.47%
Epoch 38/40 - Loss: 0.0590 - Accuracy: 98.09%
Validation - Loss: 0.2509 - Accuracy: 93.38%
Epoch 39/40 - Loss: 0.0552 - Accuracy: 98.05%
Validation - Loss: 0.2191 - Accuracy: 93.30%
Epoch 40/40 - Loss: 0.0376 - Accuracy: 98.71%
Validation - Loss: 0.1997 - Accuracy: 94.23%
Best model saved at epoch 11 with accuracy: 93.98%
trained model
metrics plotted
Loading the best model for evaluation...
Best model loaded successfully

Metrics saved to: best_dn169_preprocessed/metrics_dn169_preprocessed.txt
Test Accuracy: 94.00%
F1 Score: 0.9412
Recall: 0.9600
Precision: 0.9231
ROC AUC: 0.9761

Confidence statistics saved to: best_dn169_preprocessed/confidence_statistics_dn169_preprocessed.txt
model evaluated
it took:  1234.2694087028503
training time saved
Finished training process.
