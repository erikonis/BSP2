Starting...
/mnt/aiongpfs/users/ekadisa/micromamba/envs/CNN-project/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/mnt/aiongpfs/users/ekadisa/micromamba/envs/CNN-project/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG19_Weights.IMAGENET1K_V1`. You can also use `weights=VGG19_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Entered main function. Starting training process.
start time:  1748782208.259503
Made output directory:  best_vgg19_raw/
Using device: cuda
model loaded in: 1.488192081451416
data loaded
Epoch 1/40 - Loss: 0.6824 - Accuracy: 59.16%
Validation - Loss: 0.6688 - Accuracy: 62.00%
Validation loss decreased (inf → 0.668808). Saving model...
Epoch 2/40 - Loss: 0.6691 - Accuracy: 60.39%
Validation - Loss: 0.6618 - Accuracy: 62.00%
Validation loss decreased (0.668808 → 0.661797). Saving model...
Epoch 3/40 - Loss: 0.4575 - Accuracy: 76.41%
Validation - Loss: 0.4105 - Accuracy: 66.93%
Validation loss decreased (0.661797 → 0.410517). Saving model...
Epoch 4/40 - Loss: 0.3721 - Accuracy: 83.23%
Validation - Loss: 0.3637 - Accuracy: 81.80%
Validation loss decreased (0.410517 → 0.363709). Saving model...
Epoch 5/40 - Loss: 0.3527 - Accuracy: 83.98%
Validation - Loss: 0.3421 - Accuracy: 83.70%
Validation loss decreased (0.363709 → 0.342148). Saving model...
Epoch 6/40 - Loss: 0.3399 - Accuracy: 84.62%
Validation - Loss: 0.3322 - Accuracy: 83.86%
Validation loss decreased (0.342148 → 0.332193). Saving model...
Epoch 7/40 - Loss: 0.3299 - Accuracy: 85.14%
Validation - Loss: 0.3379 - Accuracy: 83.15%
EarlyStopping counter: 1 out of 5
Epoch 8/40 - Loss: 0.3208 - Accuracy: 84.96%
Validation - Loss: 0.3532 - Accuracy: 83.62%
EarlyStopping counter: 2 out of 5
Epoch 9/40 - Loss: 0.3071 - Accuracy: 85.83%
Validation - Loss: 0.3257 - Accuracy: 86.72%
Validation loss decreased (0.332193 → 0.325740). Saving model...
Epoch 10/40 - Loss: 0.3021 - Accuracy: 86.59%
Validation - Loss: 0.3120 - Accuracy: 85.29%
Validation loss decreased (0.325740 → 0.311965). Saving model...
Epoch 11/40 - Loss: 0.2941 - Accuracy: 87.36%
Validation - Loss: 0.2952 - Accuracy: 86.57%
Validation loss decreased (0.311965 → 0.295189). Saving model...
Epoch 12/40 - Loss: 0.2819 - Accuracy: 87.82%
Validation - Loss: 0.2928 - Accuracy: 86.49%
Validation loss decreased (0.295189 → 0.292791). Saving model...
Epoch 13/40 - Loss: 0.2811 - Accuracy: 87.40%
Validation - Loss: 0.2959 - Accuracy: 86.80%
EarlyStopping counter: 1 out of 5
Epoch 14/40 - Loss: 0.2595 - Accuracy: 88.95%
Validation - Loss: 0.3077 - Accuracy: 86.49%
EarlyStopping counter: 2 out of 5
Epoch 15/40 - Loss: 0.2486 - Accuracy: 89.17%
Validation - Loss: 0.3053 - Accuracy: 87.12%
EarlyStopping counter: 3 out of 5
Epoch 16/40 - Loss: 0.2523 - Accuracy: 88.75%
Validation - Loss: 0.2810 - Accuracy: 87.36%
Validation loss decreased (0.292791 → 0.280972). Saving model...
Epoch 17/40 - Loss: 0.2487 - Accuracy: 89.33%
Validation - Loss: 0.2757 - Accuracy: 87.20%
Validation loss decreased (0.280972 → 0.275729). Saving model...
Epoch 18/40 - Loss: 0.2323 - Accuracy: 89.98%
Validation - Loss: 0.2738 - Accuracy: 87.36%
Validation loss decreased (0.275729 → 0.273752). Saving model...
Epoch 19/40 - Loss: 0.2218 - Accuracy: 90.36%
Validation - Loss: 0.2445 - Accuracy: 88.63%
Validation loss decreased (0.273752 → 0.244454). Saving model...
Epoch 20/40 - Loss: 0.2322 - Accuracy: 90.52%
Validation - Loss: 0.2559 - Accuracy: 87.92%
EarlyStopping counter: 1 out of 5
Epoch 21/40 - Loss: 0.2167 - Accuracy: 91.02%
Validation - Loss: 0.2494 - Accuracy: 89.03%
EarlyStopping counter: 2 out of 5
Epoch 22/40 - Loss: 0.2003 - Accuracy: 91.32%
Validation - Loss: 0.2457 - Accuracy: 89.35%
EarlyStopping counter: 3 out of 5
Epoch 23/40 - Loss: 0.1814 - Accuracy: 92.73%
Validation - Loss: 0.2474 - Accuracy: 89.75%
EarlyStopping counter: 4 out of 5
Epoch 24/40 - Loss: 0.1732 - Accuracy: 93.12%
Validation - Loss: 0.2435 - Accuracy: 89.83%
Validation loss decreased (0.244454 → 0.243456). Saving model...
Epoch 25/40 - Loss: 0.1783 - Accuracy: 93.10%
Validation - Loss: 0.2907 - Accuracy: 88.63%
EarlyStopping counter: 1 out of 5
Epoch 26/40 - Loss: 0.1700 - Accuracy: 92.87%
Validation - Loss: 0.2502 - Accuracy: 89.90%
EarlyStopping counter: 2 out of 5
Epoch 27/40 - Loss: 0.1482 - Accuracy: 93.94%
Validation - Loss: 0.2585 - Accuracy: 91.18%
EarlyStopping counter: 3 out of 5
Epoch 28/40 - Loss: 0.1489 - Accuracy: 94.12%
Validation - Loss: 0.2719 - Accuracy: 88.31%
EarlyStopping counter: 4 out of 5
Epoch 29/40 - Loss: 0.1384 - Accuracy: 94.61%
Validation - Loss: 0.2751 - Accuracy: 88.95%
EarlyStopping counter: 5 out of 5
Epoch 30/40 - Loss: 0.1305 - Accuracy: 94.83%
Validation - Loss: 0.2212 - Accuracy: 91.65%
Epoch 31/40 - Loss: 0.1261 - Accuracy: 94.89%
Validation - Loss: 0.2333 - Accuracy: 89.83%
Epoch 32/40 - Loss: 0.1345 - Accuracy: 94.55%
Validation - Loss: 0.2188 - Accuracy: 90.86%
Epoch 33/40 - Loss: 0.1134 - Accuracy: 95.65%
Validation - Loss: 0.2568 - Accuracy: 92.13%
Epoch 34/40 - Loss: 0.1179 - Accuracy: 95.19%
Validation - Loss: 0.2133 - Accuracy: 91.97%
Epoch 35/40 - Loss: 0.1057 - Accuracy: 95.85%
Validation - Loss: 0.2228 - Accuracy: 91.65%
Epoch 36/40 - Loss: 0.1030 - Accuracy: 95.85%
Validation - Loss: 0.2939 - Accuracy: 90.94%
Epoch 37/40 - Loss: 0.1183 - Accuracy: 95.29%
Validation - Loss: 0.2099 - Accuracy: 90.86%
Epoch 38/40 - Loss: 0.1102 - Accuracy: 95.61%
Validation - Loss: 0.2138 - Accuracy: 91.89%
Epoch 39/40 - Loss: 0.0837 - Accuracy: 96.94%
Validation - Loss: 0.3367 - Accuracy: 90.86%
Epoch 40/40 - Loss: 0.0920 - Accuracy: 96.64%
Validation - Loss: 0.2425 - Accuracy: 91.97%
Best model saved at epoch 24 with accuracy: 89.83%
trained model
metrics plotted
Loading the best model for evaluation...
Best model loaded successfully

Metrics saved to: best_vgg19_raw/metrics_vgg19_raw.txt
Test Accuracy: 93.50%
F1 Score: 0.9360
Recall: 0.9500
Precision: 0.9223
ROC AUC: 0.9735

Confidence statistics saved to: best_vgg19_raw/confidence_statistics_vgg19_raw.txt
model evaluated
it took:  1524.7452054023743
training time saved
Finished training process.
