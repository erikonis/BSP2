Starting...
/mnt/aiongpfs/users/ekadisa/micromamba/envs/CNN-project/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/mnt/aiongpfs/users/ekadisa/micromamba/envs/CNN-project/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Entered main function. Starting training process.
start time:  1748782143.698341
Made output directory:  best_vgg16_raw/
Using device: cuda
model loaded in: 1.3982460498809814
data loaded
Epoch 1/40 - Loss: 0.6792 - Accuracy: 59.24%
Validation - Loss: 0.6748 - Accuracy: 59.46%
Validation loss decreased (inf → 0.674772). Saving model...
Epoch 2/40 - Loss: 0.6769 - Accuracy: 60.08%
Validation - Loss: 0.6749 - Accuracy: 59.46%
EarlyStopping counter: 1 out of 5
Epoch 3/40 - Loss: 0.6759 - Accuracy: 59.72%
Validation - Loss: 0.6741 - Accuracy: 59.46%
Validation loss decreased (0.674772 → 0.674074). Saving model...
Epoch 4/40 - Loss: 0.6760 - Accuracy: 60.10%
Validation - Loss: 0.6727 - Accuracy: 59.46%
Validation loss decreased (0.674074 → 0.672737). Saving model...
Epoch 5/40 - Loss: 0.6743 - Accuracy: 60.10%
Validation - Loss: 0.6734 - Accuracy: 59.46%
EarlyStopping counter: 1 out of 5
Epoch 6/40 - Loss: 0.6714 - Accuracy: 60.35%
Validation - Loss: 0.6714 - Accuracy: 60.65%
Validation loss decreased (0.672737 → 0.671356). Saving model...
Epoch 7/40 - Loss: 0.5559 - Accuracy: 71.68%
Validation - Loss: 0.4435 - Accuracy: 78.70%
Validation loss decreased (0.671356 → 0.443546). Saving model...
Epoch 8/40 - Loss: 0.3872 - Accuracy: 82.47%
Validation - Loss: 0.3590 - Accuracy: 82.83%
Validation loss decreased (0.443546 → 0.359034). Saving model...
Epoch 9/40 - Loss: 0.3521 - Accuracy: 83.45%
Validation - Loss: 0.3758 - Accuracy: 84.26%
EarlyStopping counter: 1 out of 5
Epoch 10/40 - Loss: 0.3304 - Accuracy: 84.58%
Validation - Loss: 0.3409 - Accuracy: 84.50%
Validation loss decreased (0.359034 → 0.340875). Saving model...
Epoch 11/40 - Loss: 0.3127 - Accuracy: 85.55%
Validation - Loss: 0.3249 - Accuracy: 84.82%
Validation loss decreased (0.340875 → 0.324938). Saving model...
Epoch 12/40 - Loss: 0.3089 - Accuracy: 85.77%
Validation - Loss: 0.3215 - Accuracy: 84.18%
Validation loss decreased (0.324938 → 0.321535). Saving model...
Epoch 13/40 - Loss: 0.2897 - Accuracy: 86.51%
Validation - Loss: 0.3076 - Accuracy: 86.33%
Validation loss decreased (0.321535 → 0.307576). Saving model...
Epoch 14/40 - Loss: 0.2882 - Accuracy: 86.57%
Validation - Loss: 0.2844 - Accuracy: 86.41%
Validation loss decreased (0.307576 → 0.284369). Saving model...
Epoch 15/40 - Loss: 0.2698 - Accuracy: 88.08%
Validation - Loss: 0.3106 - Accuracy: 85.45%
EarlyStopping counter: 1 out of 5
Epoch 16/40 - Loss: 0.2607 - Accuracy: 88.81%
Validation - Loss: 0.2778 - Accuracy: 87.12%
Validation loss decreased (0.284369 → 0.277825). Saving model...
Epoch 17/40 - Loss: 0.2594 - Accuracy: 88.61%
Validation - Loss: 0.2765 - Accuracy: 86.88%
Validation loss decreased (0.277825 → 0.276490). Saving model...
Epoch 18/40 - Loss: 0.2481 - Accuracy: 89.47%
Validation - Loss: 0.2701 - Accuracy: 87.60%
Validation loss decreased (0.276490 → 0.270100). Saving model...
Epoch 19/40 - Loss: 0.2390 - Accuracy: 89.11%
Validation - Loss: 0.2552 - Accuracy: 87.92%
Validation loss decreased (0.270100 → 0.255153). Saving model...
Epoch 20/40 - Loss: 0.2329 - Accuracy: 90.00%
Validation - Loss: 0.2564 - Accuracy: 88.63%
EarlyStopping counter: 1 out of 5
Epoch 21/40 - Loss: 0.2351 - Accuracy: 89.98%
Validation - Loss: 0.2569 - Accuracy: 87.92%
EarlyStopping counter: 2 out of 5
Epoch 22/40 - Loss: 0.2176 - Accuracy: 90.78%
Validation - Loss: 0.2561 - Accuracy: 88.87%
EarlyStopping counter: 3 out of 5
Epoch 23/40 - Loss: 0.2072 - Accuracy: 91.69%
Validation - Loss: 0.2384 - Accuracy: 89.43%
Validation loss decreased (0.255153 → 0.238412). Saving model...
Epoch 24/40 - Loss: 0.2057 - Accuracy: 91.55%
Validation - Loss: 0.2567 - Accuracy: 88.63%
EarlyStopping counter: 1 out of 5
Epoch 25/40 - Loss: 0.1949 - Accuracy: 92.05%
Validation - Loss: 0.2718 - Accuracy: 89.90%
EarlyStopping counter: 2 out of 5
Epoch 26/40 - Loss: 0.1917 - Accuracy: 91.97%
Validation - Loss: 0.2495 - Accuracy: 89.35%
EarlyStopping counter: 3 out of 5
Epoch 27/40 - Loss: 0.1810 - Accuracy: 92.63%
Validation - Loss: 0.2881 - Accuracy: 88.24%
EarlyStopping counter: 4 out of 5
Epoch 28/40 - Loss: 0.1734 - Accuracy: 93.14%
Validation - Loss: 0.2681 - Accuracy: 88.79%
EarlyStopping counter: 5 out of 5
Epoch 29/40 - Loss: 0.1593 - Accuracy: 93.40%
Validation - Loss: 0.2409 - Accuracy: 89.51%
Epoch 30/40 - Loss: 0.1625 - Accuracy: 93.28%
Validation - Loss: 0.2568 - Accuracy: 88.55%
Epoch 31/40 - Loss: 0.1480 - Accuracy: 94.14%
Validation - Loss: 0.2712 - Accuracy: 89.43%
Epoch 32/40 - Loss: 0.1471 - Accuracy: 93.94%
Validation - Loss: 0.2657 - Accuracy: 89.35%
Epoch 33/40 - Loss: 0.1371 - Accuracy: 94.52%
Validation - Loss: 0.2376 - Accuracy: 91.10%
Epoch 34/40 - Loss: 0.1266 - Accuracy: 95.17%
Validation - Loss: 0.2813 - Accuracy: 90.54%
Epoch 35/40 - Loss: 0.1367 - Accuracy: 94.38%
Validation - Loss: 0.2449 - Accuracy: 89.27%
Epoch 36/40 - Loss: 0.1119 - Accuracy: 95.23%
Validation - Loss: 0.3358 - Accuracy: 89.43%
Epoch 37/40 - Loss: 0.1095 - Accuracy: 95.65%
Validation - Loss: 0.3044 - Accuracy: 88.79%
Epoch 38/40 - Loss: 0.1021 - Accuracy: 96.09%
Validation - Loss: 0.3009 - Accuracy: 90.14%
Epoch 39/40 - Loss: 0.1041 - Accuracy: 96.20%
Validation - Loss: 0.2680 - Accuracy: 90.70%
Epoch 40/40 - Loss: 0.0951 - Accuracy: 96.38%
Validation - Loss: 0.2281 - Accuracy: 91.81%
Best model saved at epoch 23 with accuracy: 89.43%
trained model
metrics plotted
Loading the best model for evaluation...
Best model loaded successfully

Metrics saved to: best_vgg16_raw/metrics_vgg16_raw.txt
Test Accuracy: 91.00%
F1 Score: 0.9109
Recall: 0.9200
Precision: 0.9020
ROC AUC: 0.9546

Confidence statistics saved to: best_vgg16_raw/confidence_statistics_vgg16_raw.txt
model evaluated
it took:  1434.0785639286041
training time saved
Finished training process.
