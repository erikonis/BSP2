Starting...
/mnt/aiongpfs/users/ekadisa/micromamba/envs/CNN-project/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/mnt/aiongpfs/users/ekadisa/micromamba/envs/CNN-project/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=DenseNet201_Weights.IMAGENET1K_V1`. You can also use `weights=DenseNet201_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Entered main function. Starting training process.
start time:  1748783738.5974503
Made output directory:  best_dn201_raw/
Using device: cuda
model loaded in: 0.9801254272460938
data loaded
Epoch 1/40 - Loss: 0.5254 - Accuracy: 71.74%
Validation - Loss: 0.4430 - Accuracy: 78.38%
Validation loss decreased (inf → 0.443006). Saving model...
Epoch 2/40 - Loss: 0.3433 - Accuracy: 83.55%
Validation - Loss: 0.3220 - Accuracy: 85.85%
Validation loss decreased (0.443006 → 0.321963). Saving model...
Epoch 3/40 - Loss: 0.2887 - Accuracy: 87.24%
Validation - Loss: 0.2666 - Accuracy: 88.39%
Validation loss decreased (0.321963 → 0.266558). Saving model...
Epoch 4/40 - Loss: 0.2539 - Accuracy: 89.09%
Validation - Loss: 0.2904 - Accuracy: 88.16%
EarlyStopping counter: 1 out of 5
Epoch 5/40 - Loss: 0.2276 - Accuracy: 90.16%
Validation - Loss: 0.2704 - Accuracy: 88.24%
EarlyStopping counter: 2 out of 5
Epoch 6/40 - Loss: 0.2104 - Accuracy: 91.40%
Validation - Loss: 0.2445 - Accuracy: 90.06%
Validation loss decreased (0.266558 → 0.244493). Saving model...
Epoch 7/40 - Loss: 0.2064 - Accuracy: 91.00%
Validation - Loss: 0.4262 - Accuracy: 84.98%
EarlyStopping counter: 1 out of 5
Epoch 8/40 - Loss: 0.1882 - Accuracy: 92.67%
Validation - Loss: 0.2158 - Accuracy: 91.81%
Validation loss decreased (0.244493 → 0.215800). Saving model...
Epoch 9/40 - Loss: 0.1643 - Accuracy: 93.38%
Validation - Loss: 0.2324 - Accuracy: 90.94%
EarlyStopping counter: 1 out of 5
Epoch 10/40 - Loss: 0.1586 - Accuracy: 93.64%
Validation - Loss: 0.2110 - Accuracy: 92.61%
Validation loss decreased (0.215800 → 0.210997). Saving model...
Epoch 11/40 - Loss: 0.1481 - Accuracy: 93.82%
Validation - Loss: 0.2360 - Accuracy: 90.70%
EarlyStopping counter: 1 out of 5
Epoch 12/40 - Loss: 0.1388 - Accuracy: 94.30%
Validation - Loss: 0.3341 - Accuracy: 88.55%
EarlyStopping counter: 2 out of 5
Epoch 13/40 - Loss: 0.1175 - Accuracy: 95.33%
Validation - Loss: 0.2102 - Accuracy: 92.29%
Validation loss decreased (0.210997 → 0.210230). Saving model...
Epoch 14/40 - Loss: 0.1212 - Accuracy: 95.07%
Validation - Loss: 0.2052 - Accuracy: 92.29%
Validation loss decreased (0.210230 → 0.205208). Saving model...
Epoch 15/40 - Loss: 0.1148 - Accuracy: 95.31%
Validation - Loss: 0.2336 - Accuracy: 89.83%
EarlyStopping counter: 1 out of 5
Epoch 16/40 - Loss: 0.1084 - Accuracy: 95.87%
Validation - Loss: 0.2315 - Accuracy: 91.49%
EarlyStopping counter: 2 out of 5
Epoch 17/40 - Loss: 0.1034 - Accuracy: 95.81%
Validation - Loss: 0.2361 - Accuracy: 91.65%
EarlyStopping counter: 3 out of 5
Epoch 18/40 - Loss: 0.0872 - Accuracy: 96.68%
Validation - Loss: 0.2426 - Accuracy: 91.65%
EarlyStopping counter: 4 out of 5
Epoch 19/40 - Loss: 0.0905 - Accuracy: 96.52%
Validation - Loss: 0.2007 - Accuracy: 93.56%
Validation loss decreased (0.205208 → 0.200692). Saving model...
Epoch 20/40 - Loss: 0.0770 - Accuracy: 97.18%
Validation - Loss: 0.2206 - Accuracy: 92.45%
EarlyStopping counter: 1 out of 5
Epoch 21/40 - Loss: 0.0904 - Accuracy: 96.62%
Validation - Loss: 0.2132 - Accuracy: 93.48%
EarlyStopping counter: 2 out of 5
Epoch 22/40 - Loss: 0.0790 - Accuracy: 97.10%
Validation - Loss: 0.2460 - Accuracy: 92.13%
EarlyStopping counter: 3 out of 5
Epoch 23/40 - Loss: 0.0717 - Accuracy: 97.44%
Validation - Loss: 0.2050 - Accuracy: 93.56%
EarlyStopping counter: 4 out of 5
Epoch 24/40 - Loss: 0.0686 - Accuracy: 97.44%
Validation - Loss: 0.2473 - Accuracy: 92.93%
EarlyStopping counter: 5 out of 5
Epoch 25/40 - Loss: 0.0570 - Accuracy: 97.99%
Validation - Loss: 0.2095 - Accuracy: 94.04%
Epoch 26/40 - Loss: 0.0712 - Accuracy: 97.38%
Validation - Loss: 0.2103 - Accuracy: 92.69%
Epoch 27/40 - Loss: 0.0487 - Accuracy: 98.41%
Validation - Loss: 0.2218 - Accuracy: 93.08%
Epoch 28/40 - Loss: 0.0522 - Accuracy: 98.09%
Validation - Loss: 0.2392 - Accuracy: 93.24%
Epoch 29/40 - Loss: 0.0706 - Accuracy: 97.18%
Validation - Loss: 0.2581 - Accuracy: 91.26%
Epoch 30/40 - Loss: 0.0547 - Accuracy: 97.95%
Validation - Loss: 0.2143 - Accuracy: 93.80%
Epoch 31/40 - Loss: 0.0415 - Accuracy: 98.59%
Validation - Loss: 0.2224 - Accuracy: 93.64%
Epoch 32/40 - Loss: 0.0403 - Accuracy: 98.83%
Validation - Loss: 0.2176 - Accuracy: 93.48%
Epoch 33/40 - Loss: 0.0468 - Accuracy: 98.27%
Validation - Loss: 0.2359 - Accuracy: 93.16%
Epoch 34/40 - Loss: 0.0431 - Accuracy: 98.33%
Validation - Loss: 0.3012 - Accuracy: 91.65%
Epoch 35/40 - Loss: 0.0433 - Accuracy: 98.51%
Validation - Loss: 0.2792 - Accuracy: 91.81%
Epoch 36/40 - Loss: 0.0349 - Accuracy: 98.83%
Validation - Loss: 0.2237 - Accuracy: 92.45%
Epoch 37/40 - Loss: 0.0429 - Accuracy: 98.37%
Validation - Loss: 0.2668 - Accuracy: 91.89%
Epoch 38/40 - Loss: 0.0332 - Accuracy: 98.93%
Validation - Loss: 0.2364 - Accuracy: 93.32%
Epoch 39/40 - Loss: 0.0292 - Accuracy: 98.93%
Validation - Loss: 0.2833 - Accuracy: 92.69%
Epoch 40/40 - Loss: 0.0383 - Accuracy: 98.59%
Validation - Loss: 0.2682 - Accuracy: 91.97%
Best model saved at epoch 19 with accuracy: 93.56%
trained model
metrics plotted
Loading the best model for evaluation...
Best model loaded successfully

Metrics saved to: best_dn201_raw/metrics_dn201_raw.txt
Test Accuracy: 96.00%
F1 Score: 0.9608
Recall: 0.9800
Precision: 0.9423
ROC AUC: 0.9872

Confidence statistics saved to: best_dn201_raw/confidence_statistics_dn201_raw.txt
model evaluated
it took:  1607.3627455234528
training time saved
Finished training process.
