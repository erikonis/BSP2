Starting...
/mnt/aiongpfs/users/ekadisa/micromamba/envs/CNN-project/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/mnt/aiongpfs/users/ekadisa/micromamba/envs/CNN-project/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet152_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet152_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Entered main function. Starting training process.
start time:  1748781095.6937516
Made output directory:  best_rn152_raw/
Using device: cuda
model loaded in: 2.432704448699951
data loaded
Epoch 1/40 - Loss: 0.5419 - Accuracy: 70.47%
Validation - Loss: 0.3943 - Accuracy: 79.97%
Validation loss decreased (inf → 0.394271). Saving model...
Epoch 2/40 - Loss: 0.3501 - Accuracy: 83.64%
Validation - Loss: 0.3318 - Accuracy: 85.69%
Validation loss decreased (0.394271 → 0.331775). Saving model...
Epoch 3/40 - Loss: 0.3221 - Accuracy: 85.31%
Validation - Loss: 0.3361 - Accuracy: 85.37%
EarlyStopping counter: 1 out of 5
Epoch 4/40 - Loss: 0.2989 - Accuracy: 86.01%
Validation - Loss: 0.3428 - Accuracy: 86.25%
EarlyStopping counter: 2 out of 5
Epoch 5/40 - Loss: 0.2895 - Accuracy: 87.62%
Validation - Loss: 0.2979 - Accuracy: 87.04%
Validation loss decreased (0.331775 → 0.297908). Saving model...
Epoch 6/40 - Loss: 0.2525 - Accuracy: 88.99%
Validation - Loss: 0.2530 - Accuracy: 88.87%
Validation loss decreased (0.297908 → 0.252999). Saving model...
Epoch 7/40 - Loss: 0.2378 - Accuracy: 89.73%
Validation - Loss: 0.3341 - Accuracy: 84.98%
EarlyStopping counter: 1 out of 5
Epoch 8/40 - Loss: 0.2149 - Accuracy: 91.18%
Validation - Loss: 0.2365 - Accuracy: 90.46%
Validation loss decreased (0.252999 → 0.236483). Saving model...
Epoch 9/40 - Loss: 0.2070 - Accuracy: 91.69%
Validation - Loss: 0.2249 - Accuracy: 90.46%
Validation loss decreased (0.236483 → 0.224877). Saving model...
Epoch 10/40 - Loss: 0.1872 - Accuracy: 92.31%
Validation - Loss: 0.2469 - Accuracy: 89.83%
EarlyStopping counter: 1 out of 5
Epoch 11/40 - Loss: 0.1832 - Accuracy: 92.91%
Validation - Loss: 0.2140 - Accuracy: 91.10%
Validation loss decreased (0.224877 → 0.213990). Saving model...
Epoch 12/40 - Loss: 0.1800 - Accuracy: 92.97%
Validation - Loss: 0.3692 - Accuracy: 89.03%
EarlyStopping counter: 1 out of 5
Epoch 13/40 - Loss: 0.1784 - Accuracy: 93.20%
Validation - Loss: 0.2358 - Accuracy: 89.67%
EarlyStopping counter: 2 out of 5
Epoch 14/40 - Loss: 0.1646 - Accuracy: 93.36%
Validation - Loss: 0.2500 - Accuracy: 89.67%
EarlyStopping counter: 3 out of 5
Epoch 15/40 - Loss: 0.1628 - Accuracy: 93.32%
Validation - Loss: 0.2383 - Accuracy: 89.59%
EarlyStopping counter: 4 out of 5
Epoch 16/40 - Loss: 0.1602 - Accuracy: 94.14%
Validation - Loss: 0.2615 - Accuracy: 89.59%
EarlyStopping counter: 5 out of 5
Epoch 17/40 - Loss: 0.1527 - Accuracy: 94.04%
Validation - Loss: 0.2580 - Accuracy: 89.75%
Epoch 18/40 - Loss: 0.1390 - Accuracy: 94.44%
Validation - Loss: 0.2220 - Accuracy: 91.97%
Epoch 19/40 - Loss: 0.1421 - Accuracy: 94.20%
Validation - Loss: 0.2049 - Accuracy: 92.13%
Epoch 20/40 - Loss: 0.1382 - Accuracy: 94.71%
Validation - Loss: 0.1961 - Accuracy: 92.21%
Epoch 21/40 - Loss: 0.1164 - Accuracy: 95.93%
Validation - Loss: 0.1716 - Accuracy: 93.48%
Epoch 22/40 - Loss: 0.1166 - Accuracy: 95.39%
Validation - Loss: 0.2463 - Accuracy: 90.38%
Epoch 23/40 - Loss: 0.1224 - Accuracy: 94.95%
Validation - Loss: 0.2196 - Accuracy: 91.49%
Epoch 24/40 - Loss: 0.1093 - Accuracy: 95.81%
Validation - Loss: 0.2284 - Accuracy: 91.73%
Epoch 25/40 - Loss: 0.0999 - Accuracy: 96.22%
Validation - Loss: 0.2271 - Accuracy: 90.62%
Epoch 26/40 - Loss: 0.0868 - Accuracy: 96.68%
Validation - Loss: 0.2871 - Accuracy: 91.73%
Epoch 27/40 - Loss: 0.0976 - Accuracy: 96.09%
Validation - Loss: 0.2133 - Accuracy: 92.13%
Epoch 28/40 - Loss: 0.0871 - Accuracy: 96.72%
Validation - Loss: 0.2374 - Accuracy: 91.34%
Epoch 29/40 - Loss: 0.0975 - Accuracy: 96.40%
Validation - Loss: 0.1986 - Accuracy: 93.32%
Epoch 30/40 - Loss: 0.0874 - Accuracy: 96.58%
Validation - Loss: 0.1882 - Accuracy: 93.08%
Epoch 31/40 - Loss: 0.0803 - Accuracy: 96.90%
Validation - Loss: 0.2205 - Accuracy: 91.81%
Epoch 32/40 - Loss: 0.0764 - Accuracy: 97.12%
Validation - Loss: 0.2439 - Accuracy: 93.00%
Epoch 33/40 - Loss: 0.0668 - Accuracy: 97.42%
Validation - Loss: 0.2608 - Accuracy: 92.37%
Epoch 34/40 - Loss: 0.0747 - Accuracy: 97.46%
Validation - Loss: 0.2413 - Accuracy: 92.61%
Epoch 35/40 - Loss: 0.0740 - Accuracy: 97.48%
Validation - Loss: 0.2181 - Accuracy: 92.37%
Epoch 36/40 - Loss: 0.0600 - Accuracy: 97.77%
Validation - Loss: 0.2351 - Accuracy: 92.29%
Epoch 37/40 - Loss: 0.0644 - Accuracy: 97.73%
Validation - Loss: 0.2044 - Accuracy: 92.85%
Epoch 38/40 - Loss: 0.0703 - Accuracy: 97.36%
Validation - Loss: 0.2147 - Accuracy: 92.93%
Epoch 39/40 - Loss: 0.0557 - Accuracy: 97.91%
Validation - Loss: 0.2078 - Accuracy: 92.93%
Epoch 40/40 - Loss: 0.0591 - Accuracy: 97.60%
Validation - Loss: 0.2019 - Accuracy: 92.69%
Best model saved at epoch 11 with accuracy: 91.10%
trained model
metrics plotted
Loading the best model for evaluation...
Best model loaded successfully

Metrics saved to: best_rn152_raw/metrics_rn152_raw.txt
Test Accuracy: 93.50%
F1 Score: 0.9378
Recall: 0.9800
Precision: 0.8991
ROC AUC: 0.9787

Confidence statistics saved to: best_rn152_raw/confidence_statistics_rn152_raw.txt
model evaluated
it took:  1897.7662496566772
training time saved
Finished training process.
